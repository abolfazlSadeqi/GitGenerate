@using Core
@using System.Globalization
@model CommitMessageModel

@{
    var lang = CultureInfo.CurrentCulture.TwoLetterISOLanguageName.ToUpper();
    var FA = lang == "FA";
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<div class="container py-5" @(FA ? "dir=rtl" : "")>

    <h1 class="text-center fw-bold mb-4 text-primary">
        @(FA ? "راهنمای جامع Conventional Commits + سازنده زنده کامیت" : 
               "Full Guide to Conventional Commits + Live Commit Builder")
    </h1>

    <!-- TABS -->
    <ul class="nav nav-tabs mb-4" id="myTab" role="tablist">
        <li class="nav-item">
            <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#guide">
                @(FA ? "راهنمای استاندارد" : "Standard Guide")
            </button>
        </li>
        <li class="nav-item">
            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#builder">
                @(FA ? "ساخت پیام کامیت" : "Commit Builder")
            </button>
        </li>
    </ul>

    <div class="tab-content">

        <!-- ============================================================= -->
        <!--                          TAB 1 - GUIDE                        -->
        <!-- ============================================================= -->
        <div class="tab-pane fade show active" id="guide">

            <div class="card shadow border-0 rounded-4 p-4">

                <h3 class="fw-bold text-primary mb-3">
                    @(FA ? "استاندارد Conventional Commits چیست؟" :
                           "What Are Conventional Commits?")
                </h3>

                <p class="lead">
                    @(FA
                        ? "Conventional Commits یک استاندارد رسمی و ساختارمند برای نوشتن پیام‌های کامیت است که باعث می‌شود تاریخچه پروژه واضح، قابل اتوماسیون، قابل جستجو و قابل درک برای انسان و ماشین باشد."
                        : "Conventional Commits is a structured standard for writing commit messages that makes project history readable, automatable, searchable, and easy to understand for both humans and tools."
                    )
                </p>


                <h4 class="fw-bold mt-4">@(FA ? "چرا مهم است؟" : "Why Is It Important?")</h4>

                <ul class="list-group mb-3">
                    <li class="list-group-item">
                        ✔ @(FA ? "ایجاد هماهنگی تیمی" : "Ensures team-wide consistency")
                    </li>
                    <li class="list-group-item">
                        ✔ @(FA ? "تولید خودکار CHANGELOG" : "Automatic changelog generation")
                    </li>
                    <li class="list-group-item">
                        ✔ @(FA ? "تعیین نوع نسخه (Semantic Versioning) به شکل خودکار" : 
                                   "Automatically drives semantic versioning")
                    </li>
                    <li class="list-group-item">
                        ✔ @(FA ? "قابلیت پردازش توسط ابزارها (Release automation / CI/CD)" :
                                   "Machine-processable (Release automation, CI/CD)")
                    </li>
                    <li class="list-group-item">
                        ✔ @(FA ? "مشخص کردن دلیل هر تغییر" :
                                   "Makes the reason behind each change explicit")
                    </li>
                </ul>


                <h4 class="fw-bold mt-4">@(FA ? "ساختار پیام کامیت" : "Commit Message Structure")</h4>

                <pre class="bg-dark text-light p-3 rounded">
type(scope): short description

body (optional)

BREAKING CHANGE: details (optional)

footer (optional)
                </pre>

                <p>
                    @(FA
                        ? "در ادامه تمامی بخش‌ها را با جزئیات توضیح داده‌ایم:"
                        : "Below is a detailed explanation of each part:")
                </p>

                <h5 class="fw-bold mt-3">1) type</h5>
                <p>@(FA ? "نوع تغییر انجام‌شده را مشخص می‌کند." : "Defines the type of change made.")</p>

                <ul class="list-group mb-3">
                    <li class="list-group-item"><strong>feat:</strong> @(FA ? "قابلیت جدید" : "new feature")</li>
                    <li class="list-group-item"><strong>fix:</strong> @(FA ? "رفع باگ" : "bug fix")</li>
                    <li class="list-group-item"><strong>docs:</strong> @(FA ? "تغییر مستندات" : "documentation")</li>
                    <li class="list-group-item"><strong>style:</strong> @(FA ? "تغییر ظاهر/فرمت کد" : "code formatting")</li>
                    <li class="list-group-item"><strong>refactor:</strong> @(FA ? "بازطراحی کد بدون تغییر رفتار" : "refactoring")</li>
                    <li class="list-group-item"><strong>perf:</strong> @(FA ? "بهبود عملکرد" : "performance improvements")</li>
                    <li class="list-group-item"><strong>test:</strong> @(FA ? "اضافه/اصلاح تست" : "tests")</li>
                    <li class="list-group-item"><strong>build:</strong> @(FA ? "تنظیمات Build" : "build changes")</li>
                    <li class="list-group-item"><strong>ci:</strong> @(FA ? "تنظیمات CI/CD" : "CI/CD changes")</li>
                    <li class="list-group-item"><strong>chore:</strong> @(FA ? "کارهای متفرقه" : "misc changes")</li>
                    <li class="list-group-item"><strong>revert:</strong> @(FA ? "بازگردانی کامیت" : "revert")</li>
                </ul>

                <h5 class="fw-bold mt-3">2) scope</h5>
                <p>@(FA ? "دامنه تغییرات؛ مثل ui, auth, api" : "Scope of the change, e.g., ui, api, auth")</p>

                <h5 class="fw-bold mt-3">3) description</h5>
                <p>@(FA ? "توضیح خیلی کوتاه، مختصر و دقیق درباره تغییر" :
                         "Short, direct summary of the change")</p>

                <h5 class="fw-bold mt-3">4) body (optional)</h5>
                <p>@(FA ? "توضیح کامل درباره چرایی تغییر" :
                         "Detailed explanation about the change")</p>

                <h5 class="fw-bold text-danger mt-3">5) BREAKING CHANGE (optional)</h5>
                <p class="text-danger">
                    @(FA ? "اگر رفتار سیستم شکسته و ناسازگار شده باشد باید استفاده شود." :
                           "Used only when backward compatibility is broken.")
                </p>

                <h5 class="fw-bold mt-3">6) footer</h5>
                <p>@(FA ? "ارجاع، شماره Issue، لینک، اطلاعات اضافی" :
                         "Issue references, links, extra notes")</p>


            </div>
        </div>

        <!-- ============================================================= -->
        <!--                    TAB 2 - BUILDER (LIVE)                     -->
        <!-- ============================================================= -->
        <div class="tab-pane fade" id="builder">

            <div class="card shadow-lg border-0 rounded-4 p-4">

                <h3 class="fw-bold text-primary mb-3">
                    @(FA ? "سازنده زنده پیام کامیت" : "Live Commit Message Builder")
                </h3>

                <!-- Commit Type -->
                <div class="mb-3">
                    <label class="form-label fw-bold">@(
                        FA ? "نوع کامیت" : "Commit Type"
                    )</label>

                    <select id="type" class="form-select live">
                        <option value="feat">feat</option>
                        <option value="fix">fix</option>
                        <option value="docs">docs</option>
                        <option value="style">style</option>
                        <option value="refactor">refactor</option>
                        <option value="perf">perf</option>
                        <option value="test">test</option>
                        <option value="build">build</option>
                        <option value="ci">ci</option>
                        <option value="chore">chore</option>
                        <option value="revert">revert</option>
                    </select>
                </div>

                <!-- Scope -->
                <div class="mb-3">
                    <label class="form-label fw-bold">
                        @(FA ? "دامنه (اختیاری)" : "Scope (optional)")
                    </label>
                    <input id="scope" class="form-control live" placeholder="ui / api / auth" />
                </div>

                <!-- Description -->
                <div class="mb-3">
                    <label class="form-label fw-bold">
                        @(FA ? "توضیح کوتاه" : "Short Description")
                    </label>
                    <input id="description" class="form-control live" placeholder="Add login page" />
                </div>

                <!-- Body -->
                <div class="mb-3">
                    <label class="form-label fw-bold">
                        @(FA ? "بدنه (اختیاری)" : "Body (optional)")
                    </label>
                    <textarea id="body" class="form-control live" rows="2"></textarea>
                </div>

                <!-- Breaking -->
                <div class="mb-3">
                    <label class="form-label fw-bold text-danger">
                        @(FA ? "تغییر ناسازگار (اختیاری)" : "Breaking Change (optional)")
                    </label>
                    <textarea id="breaking" class="form-control live" rows="2"></textarea>
                </div>

                <!-- Footer -->
                <div class="mb-3">
                    <label class="form-label fw-bold">
                        @(FA ? "پاورقی (Issue / لینک)" : "Footer (optional)")
                    </label>
                    <textarea id="footer" class="form-control live" rows="2"></textarea>
                </div>

                <!-- Preview -->
                <h5 class="fw-bold mt-4">
                    @(FA ? "پیش‌نمایش کامیت" : "Commit Preview")
                </h5>

                <pre id="preview" class="bg-dark text-success p-3 rounded" style="min-height:160px;"></pre>

                <button class="btn btn-success mt-3" id="copyBtn">
                    @(FA ? "کپی" : "Copy")
                </button>

            </div>
        </div>

    </div>

</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
function updatePreview() {
    const type = document.getElementById("type").value.trim();
    const scope = document.getElementById("scope").value.trim();
    const desc = document.getElementById("description").value.trim();
    const body = document.getElementById("body").value.trim();
    const breaking = document.getElementById("breaking").value.trim();
    const footer = document.getElementById("footer").value.trim();

    let msg = type;
    if (scope) msg += `(${scope})`;
    msg += `: ${desc}`;

    if (body) msg += `\n\n${body}`;
    if (breaking) msg += `\n\nBREAKING CHANGE: ${breaking}`;
    if (footer) msg += `\n\n${footer}`;

    document.getElementById("preview").textContent = msg;
}

document.querySelectorAll(".live").forEach(i => i.addEventListener("input", updatePreview));
updatePreview();

document.getElementById("copyBtn").addEventListener("click", function () {
    navigator.clipboard.writeText(document.getElementById("preview").textContent);
    this.textContent = "Copied!";
    setTimeout(() => this.textContent = "Copy", 1200);
});
</script>


}